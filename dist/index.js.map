{"version":3,"sources":["../src/index.js"],"names":["cors","require","app","use","bodyParser","json","port","process","env","PORT","express","urlencoded","extended","authenticate","req","res","next","httpRequest","then","statusCode","console","log","message","catch","e","post","sendmailController","get","headers","data","set","status","send","end","all","staffController","put","activitiesController","delete","subscriberController","authController","listen"],"mappings":";;AAAA;;AACA;;AAEA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;AAEA,IAAIA,IAAI,GAAGC,OAAO,CAAC,MAAD,CAAlB;;AACA,MAAMC,GAAG,GAAG,uBAAZ;AACAA,GAAG,CAACC,GAAJ,CAAQC,oBAAWC,IAAX,EAAR;AAEA,MAAMC,IAAI,GAAGC,OAAO,CAACC,GAAR,CAAYC,IAAZ,IAAoB,IAAjC,C,CAEA;;AACAP,GAAG,CAACC,GAAJ,CAAQO,iBAAQC,UAAR,CAAmB;AAAEC,EAAAA,QAAQ,EAAE;AAAZ,CAAnB,CAAR;AACAV,GAAG,CAACC,GAAJ,CAAQO,iBAAQL,IAAR,EAAR;AAEAH,GAAG,CAACC,GAAJ,CAAQH,IAAI,EAAZ;;AAGA,SAASa,YAAT,CAAuBC,GAAvB,EAA4BC,GAA5B,EAAiCC,IAAjC,EAAuC;AACrC,QAAMC,WAAW,GAAG,2BAAaH,GAAb,CAApB;AAEA,qBAAkBG,WAAlB,EACKC,IADL,CACU,CAAC;AAAEC,IAAAA;AAAF,GAAD,KAAoB;AAExB,QAAGA,UAAU,IAAI,GAAjB,EAAqB;AACnBH,MAAAA,IAAI;AACL,KAFD,MAGK;AACHI,MAAAA,OAAO,CAACC,GAAR,CAAY,qBAAZ;AACAN,MAAAA,GAAG,CAACV,IAAJ,CAAS;AAACiB,QAAAA,OAAO,EAAE;AAAV,OAAT;AACD;AAEJ,GAXH,EAYGC,KAZH,CAYSC,CAAC,IAAI;AAACJ,IAAAA,OAAO,CAACC,GAAR,CAAYG,CAAZ;AAAe,GAZ9B;AAaD;;AAGDtB,GAAG,CAACuB,IAAJ,CAAS,WAAT,EAAsBZ,YAAtB,EAAoCa,kBAApC;AACAxB,GAAG,CAACyB,GAAJ,CAAQ,WAAR,EAAqBd,YAArB,EAAmCa,kBAAnC;;AAEA,SAASA,kBAAT,CAA6BZ,GAA7B,EAAkCC,GAAlC,EAAuC;AACrC,QAAME,WAAW,GAAG,2BAAaH,GAAb,CAApB;AACA,uBAAsBG,WAAtB,EACKC,IADL,CACU,CAAC;AAAEU,IAAAA,OAAF;AAAWT,IAAAA,UAAX;AAAuBU,IAAAA;AAAvB,GAAD,KACNd,GAAG,CACEe,GADL,CACSF,OADT,EAEKG,MAFL,CAEYZ,UAFZ,EAGKa,IAHL,CAGUH,IAHV,CAFJ,EAOKN,KAPL,CAOWC,CAAC,IAAIT,GAAG,CAACgB,MAAJ,CAAW,GAAX,EAAgBE,GAAhB,EAPhB;AAQD;;AAGD/B,GAAG,CAACgC,GAAJ,CAAQ,QAAR,EAAkBrB,YAAlB,EAAgCsB,eAAhC;AACAjC,GAAG,CAACkC,GAAJ,CAAQ,QAAR,EAAkBvB,YAAlB,EAAgCsB,eAAhC;AACAjC,GAAG,CAACuB,IAAJ,CAAS,YAAT,EAAuBU,eAAvB;AACAjC,GAAG,CAACuB,IAAJ,CAAS,aAAT,EAAwBU,eAAxB;AACAjC,GAAG,CAACuB,IAAJ,CAAS,cAAT,EAAyBU,eAAzB;AACAjC,GAAG,CAACyB,GAAJ,CAAQ,YAAR,EAAsBQ,eAAtB,E,CACA;;AACAjC,GAAG,CAACyB,GAAJ,CAAQ,gBAAR,EAA0BQ,eAA1B;AACAjC,GAAG,CAACyB,GAAJ,CAAQ,2BAAR,EAAqCQ,eAArC;;AAEA,SAASA,eAAT,CAA0BrB,GAA1B,EAA+BC,GAA/B,EAAoC;AAChC,QAAME,WAAW,GAAG,2BAAaH,GAAb,CAApB;AACA,sBAAmBG,WAAnB,EACKC,IADL,CACU,CAAC;AAAEU,IAAAA,OAAF;AAAWT,IAAAA,UAAX;AAAuBU,IAAAA;AAAvB,GAAD,KACNd,GAAG,CACEe,GADL,CACSF,OADT,EAEKG,MAFL,CAEYZ,UAFZ,EAGKa,IAHL,CAGUH,IAHV,CAFJ,EAOKN,KAPL,CAOWC,CAAC,IAAIT,GAAG,CAACgB,MAAJ,CAAW,GAAX,EAAgBE,GAAhB,EAPhB;AAQH;;AAID/B,GAAG,CAACyB,GAAJ,CAAQ,aAAR,EAAuBU,oBAAvB;AACAnC,GAAG,CAACuB,IAAJ,CAAS,iBAAT,EAA4BY,oBAA5B;AACAnC,GAAG,CAACoC,MAAJ,CAAW,iBAAX,EAA8BD,oBAA9B;AACAnC,GAAG,CAACyB,GAAJ,CAAQ,0BAAR,EAAoCU,oBAApC;AACAnC,GAAG,CAACyB,GAAJ,CAAQ,wBAAR,EAAkCU,oBAAlC;AACAnC,GAAG,CAACyB,GAAJ,CAAQ,oDAAR,EAA8DU,oBAA9D;;AAGA,SAASA,oBAAT,CAA+BvB,GAA/B,EAAoCC,GAApC,EAAyC;AAEvC,QAAME,WAAW,GAAG,2BAAaH,GAAb,CAApB;AACA,2BAAwBG,WAAxB,EACGC,IADH,CACQ,CAAC;AAAEU,IAAAA,OAAF;AAAWT,IAAAA,UAAX;AAAuBU,IAAAA;AAAvB,GAAD,KACJd,GAAG,CACAe,GADH,CACOF,OADP,EAEGG,MAFH,CAEUZ,UAFV,EAGGa,IAHH,CAGQH,IAHR,CAFJ,EAOGN,KAPH,CAOSC,CAAC,IAAIT,GAAG,CAACgB,MAAJ,CAAW,GAAX,EAAgBE,GAAhB,EAPd;AAQD;;AAKD/B,GAAG,CAACgC,GAAJ,CAAQ,aAAR,EAAuBK,oBAAvB;AACArC,GAAG,CAACuB,IAAJ,CAAS,iBAAT,EAA4Bc,oBAA5B;AACArC,GAAG,CAACkC,GAAJ,CAAQ,aAAR,EAAuBG,oBAAvB;AACArC,GAAG,CAACuB,IAAJ,CAAS,oBAAT,EAA+Bc,oBAA/B;AACArC,GAAG,CAACoC,MAAJ,CAAW,oBAAX,EAAiCC,oBAAjC;AACArC,GAAG,CAACyB,GAAJ,CAAQ,iBAAR,EAA2BY,oBAA3B;AACArC,GAAG,CAACyB,GAAJ,CAAQ,oBAAR,EAA8BY,oBAA9B;;AAEA,SAASA,oBAAT,CAA+BzB,GAA/B,EAAoCC,GAApC,EAAyC;AAEvC,QAAME,WAAW,GAAG,2BAAaH,GAAb,CAApB;AACA,4BAAwBG,WAAxB,EACGC,IADH,CACQ,CAAC;AAAEU,IAAAA,OAAF;AAAWT,IAAAA,UAAX;AAAuBU,IAAAA;AAAvB,GAAD,KACJd,GAAG,CACAe,GADH,CACOF,OADP,EAEGG,MAFH,CAEUZ,UAFV,EAGGa,IAHH,CAGQH,IAHR,CAFJ,EAOGN,KAPH,CAOSC,CAAC,IAAIT,GAAG,CAACgB,MAAJ,CAAW,GAAX,EAAgBE,GAAhB,EAPd;AAQD;;AAID/B,GAAG,CAACgC,GAAJ,CAAQ,OAAR,EAAiBM,cAAjB;AACAtC,GAAG,CAACyB,GAAJ,CAAQ,WAAR,EAAqBa,cAArB;AACAtC,GAAG,CAACyB,GAAJ,CAAQ,mBAAR,EAA6Ba,cAA7B;;AAEA,SAASA,cAAT,CAAyB1B,GAAzB,EAA8BC,GAA9B,EAAmC;AACjC,QAAME,WAAW,GAAG,2BAAaH,GAAb,CAApB;AACA,qBAAkBG,WAAlB,EACKC,IADL,CACU,CAAC;AAAEU,IAAAA,OAAF;AAAWT,IAAAA,UAAX;AAAuBU,IAAAA;AAAvB,GAAD,KACNd,GAAG,CACEe,GADL,CACSF,OADT,EAEKG,MAFL,CAEYZ,UAFZ,EAGKa,IAHL,CAGUH,IAHV,CAFJ,EAOKN,KAPL,CAOWC,CAAC,IAAIT,GAAG,CAACgB,MAAJ,CAAW,GAAX,EAAgBE,GAAhB,EAPhB;AAQD;;AAGD/B,GAAG,CAACuC,MAAJ,CAAWnC,IAAX,EAAiB,MAAMc,OAAO,CAACC,GAAR,CAAa,wBAAD,GAAyBd,OAAO,CAACC,GAAR,CAAYC,IAArC,IAA6C,IAAzD,CAAvB","sourcesContent":["import express from 'express'\nimport bodyParser from 'body-parser'\n\nimport handleAuthRequest from './auth'\nimport handleStaffRequest from './staff'\nimport handleActivitiesRequest from './activities'\nimport handleSubscriberRequest from './subscribers'\nimport handleSendmailRequest from './mailer'\nimport adaptRequest from './helpers/adapt-request'\n\nvar cors = require('cors')\nconst app = express();\napp.use(bodyParser.json());\n\nconst port = process.env.PORT || 9090;\n\n//Middleware\napp.use(express.urlencoded({ extended: true}));\napp.use(express.json());\n\napp.use(cors());\n\n\nfunction authenticate (req, res, next) {\n  const httpRequest = adaptRequest(req)\n  \n  handleAuthRequest(httpRequest)\n      .then(({ statusCode }) => {\n       \n        if(statusCode == 200){\n          next();\n        } \n        else {\n          console.log(\"Unauthorized access\")\n          res.json({message: \"Unauthorized access\"})\n        }\n\n    })\n    .catch(e => {console.log(e)})\n}\n\n\napp.post('/sendmail', authenticate, sendmailController);\napp.get('/sendmail', authenticate, sendmailController);\n\nfunction sendmailController (req, res) {\n  const httpRequest = adaptRequest(req)\n  handleSendmailRequest(httpRequest)\n      .then(({ headers, statusCode, data }) =>\n      res\n          .set(headers)\n          .status(statusCode) \n          .send(data)\n      )\n      .catch(e => res.status(500).end())\n}\n\n\napp.all('/staff', authenticate, staffController);\napp.put('/staff', authenticate, staffController);\napp.post('/staff/add', staffController);\napp.post('/staff/auth', staffController);\napp.post('/staff/reset', staffController);\napp.get('/staff/:id', staffController);\n// app.delete('/staff/?id=:id', staffController);\napp.get('/staff/?id=:id', staffController);\napp.get('/staff/find/?email=:email', staffController);\n\nfunction staffController (req, res) {\n    const httpRequest = adaptRequest(req)\n    handleStaffRequest(httpRequest)\n        .then(({ headers, statusCode, data }) =>\n        res\n            .set(headers)\n            .status(statusCode) \n            .send(data)\n        )\n        .catch(e => res.status(500).end())\n}\n\n\n\napp.get('/activities', activitiesController);\napp.post('/activities/add', activitiesController);\napp.delete('/activities/:id', activitiesController);\napp.get('/activities?month=:month', activitiesController);\napp.get('/activities?year=:year', activitiesController);\napp.get('/activities?dday=:dday&dmonth=:dmonth&dyear=:dyear', activitiesController);\n\n\nfunction activitiesController (req, res) {\n  \n  const httpRequest = adaptRequest(req)\n  handleActivitiesRequest(httpRequest)\n    .then(({ headers, statusCode, data }) =>\n      res\n        .set(headers)\n        .status(statusCode) \n        .send(data)\n    )\n    .catch(e => res.status(500).end())\n}\n\n\n\n\napp.all('/subscriber', subscriberController);\napp.post('/subscriber/add', subscriberController);\napp.put('/subscriber', subscriberController);\napp.post('/subscriber/update', subscriberController);\napp.delete('/subscriber?id=:id', subscriberController);\napp.get('/subscriber/:id', subscriberController);\napp.get('/subscriber?id=:id', subscriberController);\n\nfunction subscriberController (req, res) {\n  \n  const httpRequest = adaptRequest(req)\n  handleSubscriberRequest(httpRequest)\n    .then(({ headers, statusCode, data }) =>\n      res\n        .set(headers)\n        .status(statusCode) \n        .send(data)\n    )\n    .catch(e => res.status(500).end())\n}\n\n\n\napp.all('/auth', authController);\napp.get('/auth/:id', authController);\napp.get('/auth/check_token', authController);\n\nfunction authController (req, res) {\n  const httpRequest = adaptRequest(req)\n  handleAuthRequest(httpRequest)\n      .then(({ headers, statusCode, data }) =>\n      res\n          .set(headers)\n          .status(statusCode) \n          .send(data)\n      )\n      .catch(e => res.status(500).end())\n}\n\n\napp.listen(port, () => console.log(`Listening on port 9090`+process.env.PORT || 9090));"],"file":"index.js"}