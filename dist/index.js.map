{"version":3,"sources":["../src/index.js"],"names":["cors","require","app","use","bodyParser","json","port","process","env","PORT","express","urlencoded","extended","authenticate","req","res","next","httpRequest","then","statusCode","console","log","message","catch","e","post","sendmailController","get","headers","data","set","status","send","end","all","staffController","put","activitiesController","delete","subscriberController","authController","listen"],"mappings":"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","sourcesContent":["import express from 'express'\nimport bodyParser from 'body-parser'\n\nimport handleAuthRequest from './auth'\nimport handleStaffRequest from './staff'\nimport handleActivitiesRequest from './activities'\nimport handleSubscriberRequest from './subscribers'\nimport handleSendmailRequest from './mailer'\nimport adaptRequest from './helpers/adapt-request'\n\nvar cors = require('cors')\nconst app = express();\napp.use(bodyParser.json());\n\nconst port = process.env.PORT || 8080;\n\n//Middleware\napp.use(express.urlencoded({ extended: true}));\napp.use(express.json());\n\napp.use(cors());\n\n\nfunction authenticate (req, res, next) {\n  const httpRequest = adaptRequest(req)\n  \n  handleAuthRequest(httpRequest)\n      .then(({ statusCode }) => {\n       \n        if(statusCode == 200){\n          next();\n        } \n        else {\n          console.log(\"Unauthorized access\")\n          res.json({message: \"Unauthorized access\"})\n        }\n\n    })\n    .catch(e => {console.log(e)})\n}\n\n\napp.post('/sendmail', authenticate, sendmailController);\napp.get('/sendmail', authenticate, sendmailController);\n\nfunction sendmailController (req, res) {\n  const httpRequest = adaptRequest(req)\n  handleSendmailRequest(httpRequest)\n      .then(({ headers, statusCode, data }) =>\n      res\n          .set(headers)\n          .status(statusCode) \n          .send(data)\n      )\n      .catch(e => res.status(500).end())\n}\n\n\napp.all('/staff', authenticate, staffController);\napp.put('/staff', authenticate, staffController);\napp.post('/staff/add', authenticate, staffController);\napp.post('/staff/auth', staffController);\n// app.post('/staff/reset', staffController);\napp.get('/staff/:id', authenticate, staffController);\n// app.delete('/staff/?id=:id', staffController);\napp.get('/staff/?id=:id', authenticate, staffController);\napp.get('/staff/find/?email=:email', authenticate, staffController);\n\nfunction staffController (req, res) {\n    const httpRequest = adaptRequest(req)\n    handleStaffRequest(httpRequest)\n        .then(({ headers, statusCode, data }) =>\n        res\n            .set(headers)\n            .status(statusCode) \n            .send(data)\n        )\n        .catch(e => res.status(500).end())\n}\n\n\n\napp.get('/activities', authenticate, activitiesController);\napp.post('/activities/add', authenticate, activitiesController);\napp.delete('/activities/:id', authenticate, activitiesController);\napp.get('/activities?month=:month', authenticate, activitiesController);\napp.get('/activities?year=:year', authenticate, activitiesController);\n\n\nfunction activitiesController (req, res) {\n  \n  const httpRequest = adaptRequest(req)\n  handleActivitiesRequest(httpRequest)\n    .then(({ headers, statusCode, data }) =>\n      res\n        .set(headers)\n        .status(statusCode) \n        .send(data)\n    )\n    .catch(e => res.status(500).end())\n}\n\n\n\n\napp.all('/subscriber', authenticate, subscriberController);\napp.post('/subscriber/add', authenticate, subscriberController);\napp.put('/subscriber', authenticate, subscriberController);\napp.post('/subscriber/update', authenticate, subscriberController);\napp.delete('/subscriber?id=:id', authenticate, subscriberController);\napp.get('/subscriber/:id', authenticate, subscriberController);\napp.get('/subscriber?id=:id', authenticate, subscriberController);\n\nfunction subscriberController (req, res) {\n  \n  const httpRequest = adaptRequest(req)\n  handleSubscriberRequest(httpRequest)\n    .then(({ headers, statusCode, data }) =>\n      res\n        .set(headers)\n        .status(statusCode) \n        .send(data)\n    )\n    .catch(e => res.status(500).end())\n}\n\n\n\napp.all('/auth', authController);\napp.get('/auth/:id', authController);\napp.get('/auth/check_token', authController);\n\nfunction authController (req, res) {\n  const httpRequest = adaptRequest(req)\n  handleAuthRequest(httpRequest)\n      .then(({ headers, statusCode, data }) =>\n      res\n          .set(headers)\n          .status(statusCode) \n          .send(data)\n      )\n      .catch(e => res.status(500).end())\n}\n\n\napp.listen(port, () => console.log(`Listening on port 9090`+process.env.PORT || 8080));"],"file":"index.js"}